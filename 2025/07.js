const input = "......................................................................S......................................................................,.............................................................................................................................................,......................................................................^......................................................................,.............................................................................................................................................,.....................................................................^.^.....................................................................,.............................................................................................................................................,....................................................................^.^.^....................................................................,.............................................................................................................................................,...................................................................^.^.^.^...................................................................,.............................................................................................................................................,..................................................................^...^.^.^..................................................................,.............................................................................................................................................,.................................................................^...^.^.^.^.................................................................,.............................................................................................................................................,................................................................^.^.........^................................................................,.............................................................................................................................................,...............................................................^.^.^.^.......^...............................................................,.............................................................................................................................................,..............................................................^.^...^.....^...^..............................................................,.............................................................................................................................................,.............................................................^.....^.^.^.^.^...^.............................................................,.............................................................................................................................................,............................................................^.^...^...^.^.^.^.^.^............................................................,.............................................................................................................................................,...........................................................^.^...^.^.^...^.^.^.^.^...........................................................,.............................................................................................................................................,..........................................................^.^.^.^.^.......^.^.^.^.^..........................................................,.............................................................................................................................................,.........................................................^...^.^.^...^.^.....^.....^.........................................................,.............................................................................................................................................,........................................................^.^.^.^...^.^.^...^...^.^...^........................................................,.............................................................................................................................................,.......................................................^...^.^.^.....^...^.^.^.^...^.^.......................................................,.............................................................................................................................................,......................................................^.....^.^.^.^.^...^.^...^.^.^.^.^......................................................,.............................................................................................................................................,.....................................................^.^...^.^.^.^.^...^.^.^...^...^.^.^.....................................................,.............................................................................................................................................,....................................................^.....^.^.^.^.^.^.^.^.^...^.^...^.^.^....................................................,.............................................................................................................................................,...................................................^.......^.^...^...^.^...^.^.^...^.^.^.^...................................................,.............................................................................................................................................,..................................................^.^.^.^.^.^.^...^...^.......^.....^.^.^.^..................................................,.............................................................................................................................................,.................................................^...^.^...........^.^.....^.^.^.........^.^.................................................,.............................................................................................................................................,................................................^.^.....^.^...^.^.^.......^.^.^...^.^.^.^.^.^................................................,.............................................................................................................................................,...............................................^.^.^.^.^.^.....^.^.^.......^.^...^.^.^...^.^.^...............................................,.............................................................................................................................................,..............................................^.^.^.....^...^...^.^.^.....^...........^.^.^.^.^..............................................,.............................................................................................................................................,.............................................^.^.....^.^.......^...^.^.^.^.^.^.^.....^.......^.^.............................................,.............................................................................................................................................,............................................^...^.^.^.^.^.^.^.^...^.^...^.^.......^.^.....^.^.^.^............................................,.............................................................................................................................................,...........................................^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.....^.^.^.......^.^...........................................,.............................................................................................................................................,..........................................^.^...^.^...^.^.^...^.^...^.^.^.^.^...^.^...^.^.^.....^.^..........................................,.............................................................................................................................................,.........................................^...^...^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^...^.^...^...^.^.........................................,.............................................................................................................................................,........................................^.^.....^.^.^.^...^.^...^.^.^.^.^.^.^...^...^...^.....^.^.^.^........................................,.............................................................................................................................................,.......................................^.^...^.....^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.......................................,.............................................................................................................................................,......................................^.^...^.^.....^.^...^.^.^.^...^.^.^.^.....^.^...^.^.^...^.......^......................................,.............................................................................................................................................,.....................................^.^.^...^.^.^.......^...^.^.^.^.^...^.^.^...^.^.....^.^.........^.^.....................................,.............................................................................................................................................,....................................^...^.....^.^...^.^.......^.^.....^.....^.^...^...^.^.^...^.^.....^.^....................................,.............................................................................................................................................,...................................^.....^.^.^.^.^.^.^...^.^...^.^...^...^...^.^.^...^.^.^.^...^.^.^.^.^.^...................................,.............................................................................................................................................,..................................^.^.^...^.^...^.^.^.......^.^...^.^.^...^.^.^.^.^.....^.^.^.^...^.^.^.^.^..................................,.............................................................................................................................................,.................................^.^.^.....^.....^...^...^.^.^.^.^.^.^.^...^.^.^.^...^...^.^...^.^...^.....^.................................,.............................................................................................................................................,................................^.........^...^...^.^.^.^...^.^...^.^.......^.^.^.^.^.^.^.^.^.^.............^................................,.............................................................................................................................................,...............................^...^.^...^.^.^...^.^.^.....^...^...^...^...^.^.^.^.....^...^.^.^.^.^.^...^.^.^...............................,.............................................................................................................................................,..............................^.^.^.^.^.^.....^.^.^...^...^.^.^...........^.^...^.^.^.^.^...^.^.^.^.....^.^...^..............................,.............................................................................................................................................,.............................^...^.^.^...^.^...^...^.^.....^.^.^...^.^.^...^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.............................,.............................................................................................................................................,............................^...^...^...^.^.^...^...^...^.^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^...^.^.....^.^.^.^............................,.............................................................................................................................................,...........................^.^...^.^...^...^.^.^.^...^.^.^.^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^...........................,.............................................................................................................................................,..........................^.....^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.^...^.^.....^.^.......^.....^.^.^.^.^.^.^.^.^.^..........................,.............................................................................................................................................,.........................^.^.^.^.^.^.^.^...^.^.....^.^.^...^.^.^.^.....^.^.^...^.^...^.^.^.^.^...^.^...^.^.^.^...^.^.........................,.............................................................................................................................................,........................^.^.^.^.^.^.^.^.....^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.^.....^.....^.^.....^...^.^.......^........................,.............................................................................................................................................,.......................^.....^.^.^.^...^.^...^.^.^.^.^.^...^.^.^.^...^...^.^.^.^...^.^.^.......^.^...^.^.^.^.^.^...^.^.......................,.............................................................................................................................................,......................^...^...^...^.^...^.^.^.....^.^.^...^.........^.^...^.^.^...^.^...........^.^.^.^.....^.^.....^.^......................,.............................................................................................................................................,.....................^...^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.....^.^...^.^.^.^.^.^.^.......^.^.^.^.^...^...^.^.....................,.............................................................................................................................................,....................^.^.....^.^.^.^.^.^.^.....^.^...^...^.^.^.^.^.^.....^...^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^...^.^....................,.............................................................................................................................................,...................^.^.^.^.^...^.^.^.^...^...^.^.^.....^.....^...^...^.^...^.^.^.^.^...^.....^...^.^...^.^.............^.^...................,.............................................................................................................................................,..................^.^.^.^.^.^.^.....^.^...^...^.^.......^.^.^.^.^.^...^.^.^...^.^.^.......^.^.^.^.^.^...^.^.^...^.^...^.^.^..................,.............................................................................................................................................,.................^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^...............^.^...^...^.^.^.....^.^...^.^.^.^.^...^.....^...^...^.^.^.................,.............................................................................................................................................,................^.^.^.^...^.^.....^.^.^.^.^.^...^.^.^.^...^...^.....^.^...^.^.^.^...^.^.^...^.^.^.....^.......^.^.^.....^.^.^................,.............................................................................................................................................,...............^.^.^.^.^...^.^.^...^.^...^.^.....^...^.^.^...^.....^.^.^.....^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.......^.^...............,.............................................................................................................................................,..............^.^.^.^...^.^.^.^.^.........^.^.......^.^.....^.......^.^.^.^.^.^...^.......^.^.^.^.......^.....^.^...^.....^.^.^..............,.............................................................................................................................................,.............^.^...^.^.......^.....^.^.^...^.......^.....^.....^...^.^.^.^.^.^.....^.^.....^.^.^.^.^.^...........^.^.^.^...^...^.............,.............................................................................................................................................,............^.^...^...^.^.^.^.^...^...^.......^.....^.^.....^.^...^...^.^.^...^.^...^.....^.....^...^.^.^.^.^.^...^...^.^...^.^.^............,.............................................................................................................................................,...........^.....^.^.^.^...^.^.^.^.....^...........^.^.^...^.^.^.^.^.^.....^.^...^.^...^...^...^...^.^.^...^.^.^.^.^.^.^...^.^...^...........,.............................................................................................................................................,..........^.^.^.^...^.^.......^.^.^.^...^.^.^.^...^.^.....^.^.^.^...^...^...^.^...^.^...^.^...^.^.^.^.......^.^.^.^.^...^...^.^.^.^..........,.............................................................................................................................................,.........^.^.^.^...^.^...^.......^.^...^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.......^...^.....^.^.^...^...^.........^...^.^...^.^.........,.............................................................................................................................................,........^.^.^...^...^...^.^.^.^.^.^.^.^.....^.^.^.......^.^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^...^.^.^.^...^...^.^.^...........^.^.^........,.............................................................................................................................................,.......^.^.^.^.^...^.^.^.^...^.^.....^.^.^.^.....^.^.....^.^.......^.^.^.^.^.^.......^.^.......^.^.^.^.....^...........^.^.^...^.^...^.......,.............................................................................................................................................,......^.^.^.^.^.^...^.^...^.^.^.^.....^.....^.^...^...^.^.^.....^...^.^.....^.^.^.^...^.^.^.^.....^...^.^.....^...^.......^.....^.....^......,.............................................................................................................................................,.....^.^.^...^.^.^.^.^.^.^...^.^...^.^.^.^.^.^.......^.^.^...^.........^.....^...^.^.^.^.........^.^.......^.^...^...^.^.^.....^.^...^.^.....,.............................................................................................................................................,....^...^.^.^.^.^.^.^.^.^.^...^.^...^.^...^.^.^.^.^.....^.^.......^.^...^.^...^.^.^.^.....^.^.^.....^.^...^.....^.^.^.^.^.........^.....^....,.............................................................................................................................................,...^.^.^.^...^...^.........^.^.^.^.^.^.^.^.^.^...^...........^.^...^...^.......^...^.^.^.^.^...^.^.^.^.......^.^...^.^...^.^.^.....^...^.^...,.............................................................................................................................................,..^.......^.......^.^.^...^.^.^.^.^.^.......^...^.^...^.^...^.^.^...^.^.....^...^.^.^.^.^...^...^...^.^.^.^.........^.^...^.^.^.^.^.^...^.^..,.............................................................................................................................................,.^.^.^.^.^.^.^.^.........^.........^...^.^.^.^...^...^.....^.......^...^.........^.^.^.^.^.^.^.^.^.^...^.^.^.^.......^.^.^...^.^.^.^.^.^...^.,............................................................................................................................................."
    .split(",").map(line => line.split(""));
const part1input = JSON.parse(JSON.stringify(input));

let part1 = 0;

for (let y = 0; y < part1input.length; y++) {
    for (let x = 0; x < part1input[y].length; x++) {
        if (part1input[y][x] === "|" || part1input[y][x] === "S") {
            if (!part1input[y + 1]) continue;
            if (part1input[y + 1][x] === ".") part1input[y + 1][x] = "|";
            else if (part1input[y + 1][x] === "^") {
                if (part1input[y + 1][x - 1] === ".") part1input[y + 1][x - 1] = "|";
                if (part1input[y + 1][x + 1] === ".") part1input[y + 1][x + 1] = "|";
                part1++;
            }
        }
    }
}

console.log("Part 1:", part1);

const memo = {};

function simulate(row, pos) {
    if (pos < 0 || pos >= input[row].length) return 0;

    const memoKey = `${row},${pos}`;
    if (memo[memoKey] !== undefined) return memo[memoKey];

    if (!input[row + 1]) return 1;
    if (input[row + 1][pos] === ".") return memo[memoKey] = simulate(row + 1, pos);
    else if (input[row + 1][pos] === "^") return memo[memoKey] = simulate(row + 1, pos - 1) + simulate(row + 1, pos + 1);
    else throw Error(input[row + 1][pos]);
}

const part2 = simulate(0, input[0].indexOf("S"));

console.log("Part 2:", part2);